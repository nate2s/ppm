//
// This file is part of Taffy, a mathematical programming language.
// Copyright (C) 2016-2017 Arithmagic, LLC
//
// Taffy is free software: you can redistribute it and/or modify
// it under the terms of the GNU Lesser General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Taffy is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public License
// along with this program.  If not, see <http://www.gnu.org/licenses/>.
//

import org.taffy.core.maths.*

import org.taffy.core.container.Array

global const math = new Math
global const C = new Constant

// compute PI
global const PI = 3.14159265358979323846264338327950
global const halfPI = 1.57079632679489661923132169163975

// compute E
Number pushDigitLimit: 100
global const eSeries = [Series createWithBlock: ^{ <n> 1/(n)! }]
global const e = eSeries[0, 200]
Number popDigitLimit

//
// Complex Numbers
//

// angles
global angle(z) = NaN
angle([z class] == org.taffy.core.maths.ComplexNumber
      and [z real] > 0) = atan([z imaginary] / [z real])
angle([z class] == org.taffy.core.maths.Number and z < 0) = PI
angle([z class] == org.taffy.core.maths.Number and z > 0) = 0
angle(z == 0) = NaN
angle([z class] == org.taffy.core.maths.ComplexNumber
      and [z real] < 0
      and [z imaginary] >= 0) = atan([z imaginary] / [z real]) + PI
angle([z class] == org.taffy.core.maths.ComplexNumber
      and [z real] < 0
      and [z imaginary] < 0) = atan([z imaginary] / [z real]) - PI
angle([z class] == org.taffy.core.maths.ComplexNumber
      and [z real] == 0
      and [z imaginary] > 0) = halfPI
angle([z class] == org.taffy.core.maths.ComplexNumber
      and [z real] == 0
      and [z imaginary] < 0) = -halfPI
kernel constify: "angle"

// another name for angle() is arg()
global const arg(z) = angle(z)

global const polarWithAngle(z, zAngle) = abs(z) * (cos(zAngle) + i * sin(zAngle))
global const polar(z) = polarWithAngle(z, angle(z))

//
// Logarithms
//
global ln(z) = [math ln: z]
ln([z class] == org.taffy.core.maths.Number and z < 0) = ln(-z) + i * angle(z)
ln([z class] == org.taffy.core.maths.ComplexNumber) = ln(abs(z)) + i * angle(z)
kernel constify: "ln"

global const log(b, x) = [math log: x base: b]
global const lg(x) = [math lg: x]
global const log10(x) = [math log10: x]
global const min = ^{ <left, right>
    if (left < right)
    {
        return left
    }

    return right
}

global const max = ^{ <left, right>
    if (left > right)
    {
        return left
    }

    return right
}

global const floor(x) = [x floor]
global const ceiling(x) = [x ceiling]

global const abs(x) = [x absoluteValue]

global sqrt(x) = [x squareRoot]
sqrt([x class] == org.taffy.core.maths.ComplexNumber) = x^0.5
sqrt(x < 0) = sqrt(-x) * i
kernel constify: "sqrt"

global const fact(x) = [x factorial]

global const choose(n, k) = [math choose: n and: k]
choose(0, k) = 0
choose(n, 0) = 1
choose(n, k < 0) = 0
choose(n < 0, k) = 0
kernel constify: "choose"

global const mod(x, y) = x % y

global const id(x) = x
global const eye(n) = [Matrix eye: n]

global const rand(x) = ([math random] % x)
rand setMemorySize: 0

global const cross3(x,y) = || x[1] * y[2] - x[2] * y[1]
                              x[2] * y[0] - x[0] * y[2]
                              x[0] * y[1] - x[1] * y[0] ||

global const conjugate(x) = [x conjugate]
global const derive(x) = [x derive]
global const integrate(x) = [x integrate]
global const simplify(x) = [x simplify]

global const NaN = [math nAn]

// least common multiple
global const lcm(a, b) = abs(a * b) / gcd(a, b)

// euclid's algorithm, could be sped up
global gcd(a, b) = absGcd(abs(a), abs(b))
global absGcd(a, b) = absGcd(b, a % b)
absGcd(a, 0) = a
kernel constify: "gcd"

// the first 200 bernoulli numbers, generated via examples/bernoulliGenerator.ty
global const bernoulliArray = [
    1,
    -0.5,
    0.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667,
    0,
    -0.033333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333334,
    0,
    0.0238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095238095230,
    0,
    -0.0333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333334,
    0,
    0.0757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757,
    0,
    -0.2531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135531135,
    0,
    1.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666659,
    0,
    -7.0921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627448,
    0,
    54.9711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884711779448621553884704,
    0,
    -529.1242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242424242233,
    0,
    6192.123188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449279,
    0,
    -86580.25311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355311355239,
    0,
    1425517.16666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666677,
    0,
    -27298231.0678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505454,
    0,
    601580873.900642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384303868174835916771400642368384304118,
    0,
    -15116315767.092156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274505334,
    0,
    429614643061.16666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666721,
    0,
    -13711655205088.3327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616327721590879485616346450,
    0,
    488332318973593.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666680657,
    0,
    -19296579341940068.14863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448632668144863266814486326681448624545,
    0,
    841693047573682615.0005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374307862679955703211517165005537098560354374211688,
    0,
    -40338071854059455413.076811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289855072463768115942028985507246376811594202898550724637681159420289854894234,
    0,
    2115074863808199160560.1453900709219858156028368794326241134751773049645390070921985815602836879432624113475177304964539007092198581560283687943262411347517730496453900709219858156028368794326241134751773049645390070921985815602836879432624113475177304964539007092198581560283687943262411347517730496453900709219858156028368794326241134751773049645390070921985815602836879432624113475177304964539007092198581560283687943262411347517730496453900709219858225962,
    0,
    -120866265222965259346027.311937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407670760611937082525317819435466494290023701788407643517,
    0,
    7500866746076964366855720.07575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757493666,
    0,
    -503877810148106891413789303.0522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861634340322,
    0,
    36528776484818123335110430842.97117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538847117794486215538613340,
    0,
    -2849876930245088222626914643291.0678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298850574712643678160919540229885057471264367816091954022988505747126436781609195402298991363,
    0,
    238654274996836276446459819192192.149717514124293785310734463276836158192090395480225988700564971751412429378531073446327683615819209039548022598870056497175141242937853107344632768361581920903954802259887005649717514124293785310734463276836158192090395480225988700564971751412429378531073446327683615819209039548022598870056497175141242937853107344632768361581920903954802259887005649717514124293785310734463276836158192090395480225988702865304,
    0,
    -21399949257225333665810744765191097.3926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659158222352299560126106926741511617238745742183076926598872659217272,
    0,
    2050097572347809756992173309567231025.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666745977,
    0,
    -209380059113463784090951852900279701847.09215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215691333002,
    0,
    22752696488463515559649260352769264581469.965405889805630233923549952102839838076697259046382991872933469299465405889805630233923549952102839838076697259046382991872933469299465405889805630233923549952102839838076697259046382991872933469299465405889805630233923549952102839838076697259046382991872933469299465405889805630233923549952102839838076697259046382991872933469299465405889805630233923549952102839838076697259046382991862109259,
    0,
    -2625771028623957604730304973615820208144900.03333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333299663330,
    0,
    321250821027180325182047923042649852435219411.061673068715322236448997012377294067434912505335040546308151941954758856167306871532223644899701237729406743491250533504054630815194195475885616730687153222364489970123772940674349125053350405463081519419547588561673068715322236448997012377294067434912505335040546308151941954758856167306871532223644899701237729406743491250533504054630815194195475885616730687153222364489969915452193,
    0,
    -41598278166794710913917074495262358936689603011.3464707892249348630026351727865786986190735289509622602629091453893184246464707892249348630026351727865786986190735289509622602629091453893184246464707892249348630026351727865786986190735289509622602629091453893184246464707892249348630026351727865786986190735289509622602629091453893184246464707892249348630026351727865786986190735289509622602629091453893184246464707892247210684,
    0,
    5692069548203528002388345621912105864448051297181.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666728086566,
    0,
    -821836294197845756922906534686173330145508927628860.0333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333147125600,
    0,
    125029043271669930167323398297028955241771963644484775.011151295961422543701024713682941531042796865581675708257986738999397227245328511151295961422543701024713682941531042796865581675708257986738999397227245328511151295961422543701024713682941531042796865581675708257986738999397227245328511151295961422543701024713682941531042796865581675708257986738999397227245328511151295961422543701024713682941531042796865501632297,
    0,
    -20015583233248370274925329198813298768724220132825915915.2074561975566279726968392678579192209034389809138733098560932133385504978044432850745619755662797269683926785791922090343898091387330985609321333855049780444328507456197556627972696839267857919220903438980913873309856093213338550497804443285074561975566279726968392678579192209034389809138733098560932133385504978044432850745619755662797269683926785792428353333,
    0,
    3367498291536437423339667690333875301621959894719384367232.15461847389558232931726907630522088353413654618473895582329317269076305220883534136546184738955823293172690763052208835341365461847389558232931726907630522088353413654618473895582329317269076305220883534136546184738955823293172690763052208835341365461847389558232931726907630522088353413654618473895582329317269076305220883534136546184738955823292251690806,
    0,
    -594709705031354477186604968440515408405790715651069049904704.3108521256877311408185506020309548777872755418866084463518304737230158240583260631376108521256877311408185506020309548777872755418866084463518304737230158240583260631376108521256877311408185506020309548777872755418866084463518304737230158240583260631376108521256877311408185506020309548777872755418866084463518304737230158240583260631376108512162386301,
    0,
    110119103236279775595641307904376916046305114442231488626999497.16666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666665790436667,
    0,
    -21355259545253501188658385019041065678973298739163469211804590304.088047549259078326005536557563914671877544373880475492590783260055365575639146718775443738804754925907832600553655756391467187754437388047549259078326005536557563914671877544373880475492590783260055365575639146718775443738804754925907832600553655756391467187754437388047549259078326005536557563914671877544373880475492590783260055375961787915,
    0,
    4332889698664119241961661305937920621845136851180910914498655788032.8480107894369354471222043378240322213157527249208064148641398216949999632512365958885483503480107894369354471222043378240322213157527249208064148641398216949999632512365958885483503480107894369354471222043378240322213157527249208064148641398216949999632512365958885483503480107894369354471222043378240322213157527249208064148644970817469,
    0,
    -918855282416693282262005552155018971389603889162719959591004487113437.054609929078014184397163120567375886524822695035460992907801418439716312056737588652482269503546099290780141843971631205673758865248226950354609929078014184397163120567375886524822695035460992907801418439716312056737588652482269503546099290780141843971631205673758865248226950354609929078014184397163120567375886524822695138819083332,
    0,
    203468967763290744934550279902200200659751402533782770239369184214108241.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666451005647001,
    0,
    -47003833958035731078575255535006060654596737369759057915139763564120483354.32224636087583328335299226748589999044820148519360162780417480235551794072109414741312861385632762224636087583328335299226748589999044820148519360162780417480235551794072109414741312861385632762224636087583328335299226748589999044820148519360162780417480235551794072109414741312861385632762224636087583328335299487190854330,
    0,
    11318043445484249270675186257733934267890365954750747918178993541665491176373.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666630937555656,
    0,
    -2838224957069370695926415633648176473828468092801288212822853171446486511107028.1341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414341434143414498715452990,
    0,
    740642489796788506297508271409209841768797317880887066731161003487485328441210855.01410078594544613962089690245030050855293573740175681923254738788719371243643088303282478039759593157651410078594544613962089690245030050855293573740175681923254738788719371243643088303282478039759593157651410078594544613962089690245030050855293573740175681923254738788719371243643088303282478039796842870049,
    0,
    -200964548027566044834656196727153631868672708225328766243461301989213565009779698883.0522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201257861635220125786163522012578616352201262296673434,
    0,
    56657170050805941445719346030519356961419468287510420621387564452152460861972277798400.15732087227414330218068535825545171339563862928348909657320872274143302180685358255451713395638629283489096573208722741433021806853582554517133956386292834890965732087227414330218068535825545171339563862928348909657320872274143302180685358255451713395638629283489096573208722741433021800254948564951,
    0,
    -16584511154136216915823713374319912301494962614725464727402466815589878137712650743149939.341946471014554066219928122390700855210753810464095350623597847161343057045616195785196268054790507711801772641946471014554066219928122390700855210753810464095350623597847161343057045616195785196268054790507711801772641946471014554066219928122390700855210753810464095350623597847164607086179644,
    0,
    5036885995049237741928942191518015481244237426490321414152565132252831097674298932791785387.0322793148880105401844532279314888010540184453227931488801054018445322793148880105401844532279314888010540184453227931488801054018445322793148880105401844532279314888010540184453227931488801054018445322793148880105401844532279314888010540184453227931488801054018445322793148887619091905767,
    0,
    -1586146823765818636936340157296643878274097841277896388047286451429731136509885006831200945121.13548917888791158819340980212652653371388225720559813794300143005020134388818084450747036684676922340495551287344354891788879115881934098021265265337138822572055981379430014300502013438881808445074703668467692234049555128734435489178887911588193409802126526533713882257201103602103011,
    0,
    517567436175456269840732406825071225612408492359305508590621669403181082957966515497718776632444.023809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809523809517142109493400,
    0,
    -174889218402171173396900258776181591451414761618265448726273472158762122895238400153326666438279521.0502824858757062146892655367231638418079096045197740112994350282485875706214689265536723163841807909604519774011299435028248587570621468926553672316384180790960451977401129943502824858757062146892655367231638418079096045197740112994350282485875706214689265536761000334333334,
    0,
    61160519994952185255824525264264167780767726846783200716843240112735747507634410314895296059086182633.16666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666687996667667100,
    0,
    -22122776912707834942288323456712932445573185054987780150566552693027736635002572659102528031391154956836.417064395064162898964462210131684277509818261259620199915049717064395064162898964462210131684277509818261259620199915049717064395064162898964462210131684277509818261259620199915049717064395064162898964462210131684277509818261259620199915049717064395239010690410509,
    0,
    8272277679877096985422106245998459573120465051843356628384885298858447202350071888172185613016339661427405.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666400634002326667,
    0,
    -3195892511141570958359163436918081487352627667109911227318450424311953111814531480454398120342282422969820300.033333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333337336936783431,
    0,
    1275008222338779298231002430292667986695719179638977329516058573538220731833362242193847881912832263475958141508.940048115160635520315162563063949931595147913732325686951309788846773590265721068832124258641476424993999373089379739405279358440048115160635520315162563063949931595147913732325686951309788846773590265721068832124258641476424993999371930109223231996,
    0,
    -525009230867741338994028246245651754469198940377552432607801345222270181833065745383064045281411494212737075399447.0921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215686274509803921568627450980392156862745098039215354071010033333,
    0,
    223018178942416252098692981988387281437382721508758785424905507810380363451712245962893177387681457638137258286208931.06812398797131621559102475133009484154522322461253758963682627804765209345362017117742308582003238491788110108720795743696507055285681239879713162155910247513300948415452232246125375896368262780476520934536201711774230858198254670609720435,
    0,
    -97684521930955204438633513398980239301166902674985678971000170661895983711329844759158434488299944780185742512315481910.311517187117446689153373124820237085000225817876693931203989607623611517187117446689153373124820237085000225817876693931203989607623611517187117446689153373124820237085000225817876693931203989607623611517187117446689159351061567709757,
    0,
    44098361978452954272272622874813169191875754265528114735319759140111294265281756787997886065208739058110782439891580698361.166666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666756666666666657,
    0,
    -20508570886464088839729337727583015486456596690400835953087398275481859426430222089186918602388746894815454424764273682977287.0406326034063260340632603406326034063260340632603406326034063260340632603406326034063260340632603406326034063260340632603406326034063260340632603406326034063260340632603406326034063260340632603406326034063261441642603306023,
    0,
    9821443327979127710757296960209752104149185799072410705583196274811683181939115856580267855114057414721266530821204999429964677.99533868346052641169738980851792729949778778800667672548890978402688183799464987280692163594352481540603383554554532665660784442354930645149533868346052641169738980851792729949778778800667672548890978405940814008367760,
    0,
    -4841260079820888050878919670996341276113054994232462038511585625800263150652152555217830953721687111431235327279572526224667309229.172809689905367418723416780726154208427156460182200833002192885631448040384417266398810837858919451925765670301852914771807438150323045903424728096899053674187234167807261542084271564601822008330042909090006464433,
    0,
    2455308880148098260978346740408869039967369503998440446032479832901257676930273851094994364868624711701580582425733759434678897524865.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666710099999336667100,
    0,
    -1280692680408474754878251327860178572181183417119632011809521429908427882645327686944705780380037383050883058628440358894326745245777738.40529431863669956888498811396304928685436764659802108379232091009520077758764725981317015712028223161010811038377941130390343673349738068343607170529431863669956888498811396304928685436946640850069974500,
    0,
    686761671046685811921018885984644004360924268134756858995636280005798377113920714142635001436984206381706690580233837164506211947331637477.16666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666639000033000096677,
    0,
    -378464685819691046949789954163795568144895492650402997945521404008267980129451551070429864341467838025357177777927557448308266296382227717751.040044742729306487695749440715883668903803131991051454138702460850111856823266219239373601789709172259507829977628635346756152125279642058165548098434004474272930648769574943999262733557290020,
    0,
    214261012506652915508713231351482720966601526029650951415596348934478293248460575061213006604801160955717270014726431021090606783849241293313384.8940198518280124774463590955793476622359339727423470213472349768013087816548615523193604800099138915631118151947034664402748145538147674443337763141223940198518280124774775580150704693499,
    0,
    -124567271371836950070196429616376072194582984382964431725616904239413657710949069481888454660417671340411845820630576985094164195281029543793193520.03333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333799686264433333433,
    0,
    74345787551000152543679668394052061311780714872902675608643307896745516938455534843831051118279910929314897740934831271860073363976821809404713103508.123188405797101449275362318840579710144927536231884057971014492753623188405797101449275362318840579710144927536231884057971014492753623188405797101449275362316821153756666670001,
    0,
    -45535795304641704894063333223321274876772114534277160901794185563554661092679704253013898315109171870084423423319549792635298912486331125393726615424111.291009132241548622856249282600789159610138709839177924349040892664696400554584591009132241548622856249282600789159610138709839177924349040892664696400554679849099227735212,
    0,
    28612112816858868345363847251017232522918987045671594025083355877551358032893091999867644645062335548288043497378270596646795401420399495875113795593003153.1666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666664846033558933336667,
    0,
    -18437723552033869727688202653628785487541402926335260270034458408149393245849484726102903484283419354319667413610910191555877583414761557944288440165302368315.20745619755662797269683926785791922090343898091387330985609321333855049780444328507456197556627972696839267857919220903438980913873309856093207264425437663334000,
    0,
    12181154536221046699501316506599521355817430663167015060351971806696491081805740427482538001277493077712826666777525052789561241031300248584464458144840696728273.965042975537002014238049110506327167612282239340682995833141135046204468225779171856020419146024570629026554115349724003259682949705552212664701674424273255,
    0,
    -8248218718531412154848184572968934473014189165923150629772438708405761023420321522571857987365839684671957157748515793206805258967279060492406431143486480062730953.045381526104417670682730923694779116465863453815261044176706827309236947791164658634538152610441767068273092369477911646586345381524999999989929803373,
    0,
    5722587793783294332965164981429786159186848661232743012547992925452097589473176611480245262184824544007231844921421279120593064575317447752808171781191785101612590640.1606786427145708582834331337325349301397205588822355289421157684630738522954091816367265469061876247504990019960079840319361261688443113769121990,
    0,
    -4066853052505910472676796938311586556021957212176430833050002477541050243613769386156817839833911603693482276739187485102293576593840334537731011132660184368170811876204.31085212568773114081855060203095487778727554188660844635183047372301582405832606313761085212568773114081855060203095487753806736365827073308,
    0,
    2959609206464205006287526958158518704263792990166491321441515086474954229161923004055881386914434099583868641966942075453817143597387801102773011362040896332087613030846880.07575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575757575760174190905666466617,
    0,
    -2204952256518945750903117522734459848363785453956150622688874402440325208528888444081188046750154470476510302666979153049749712527963390550202209551679703196071229172550624183.039113680154142581888246628131021194605009633911368015414258188824662813102119460500963391136801541425818882431947977211946049863,
    0,
    1681259707288959980583115251513606657544638546482066752238975255882731155495395993071507110288067839984837346914908538300971449496714802051322184598748025681954433048122073989963.0068603712671509281678773204196933010492332526230831315577078288942695722356739305891848264729620661824170584652723671761971,
    0,
    -1311673621355695764864528063558171530044312360007082912686129596987085878510507636768715702277406389517093353228985838740819447198664421765085970669286107184742387347060222109905111.1468710786708430318878894987403852601128384915275343161201950247612479285803231893636790329224019755230738545966653313,
    0,
    1046789400947803808218328539298230896438287213885351280532629144896489596562752090744556955976129592312307555413487361911412493881391932414093169410477684445371478649587503940825192832.16108007448789571694599627560521415270018621973929236499068901303538175046554934823091247671568599781564286387670,
    0,
    -854328935788337077185982546299082774593270107898727019060442429685246974620569963551083486627920700456548943337470919889765654546216941240706306072177774046052406456347565081307079104924.477857619014572361327910062838326053577618627104653028401661563841916775549389533783866772898927845879213861,
    0,
    712878213224865423522884066771438224721244689304733715276947169770408609998265918452152635072706453523257827259775876730721498128869948015240588271088555947991935424324338392988217775167785.166666666666666666666666666666666666666666666666666666666666666666666666666666665601368976679999996667,
    0,
    -608029314555358993000847118686477458461988160092698836181181311550128675402492206160304311577645148677051336744015398098922709241642545396553613596139685245930722429453649449302505018633342017.0546099290780141843971631205673758865248226950354609929078014184397163120570706410133010003329900,
    0,
    529967764248499239300942910043247266228489712345603289760635011919038386327202085595542281866365036916065505053824670559525875890896211994543032219718035198560643844587616211673623032227002399940.0238095238095238095238095238095238095238095238095238095238095238095238625985194728236833340,
    0,
    -471942591687458626443646229013379911103760787757249268380884067657066708691597359649123718738834370055520607521810973682453509387323230602043874687828599467302385753064686229185298119362603979610700.03333333333333333333333333333333333333333333333333333333333333326032433332333323332333,
    0,
    429284137914029810894168296541074669045520981012117736327870981182293334484492274213345158457669661328438797939290986171071093376704029317883767874493431975824086108199054440194661591727744769921781651.070521973663334919879422497223544343963192130731397747104545432729990274946512733,
    0,
    -398767449682322074434477655542938795106651478560005423182351631812836582370982439948957051587030336291004292500115644971849548638665124615902544702053411423239568058179865950960866526364814222481410299257.327427708026092350710505220853775638116595267577021338651273860019001215823,
    0,
    378197804193588827138944181161393327898220238216264722872164458734960902370579449477199959996935302943455958971887316742749208993639529320718684812152514922495051767388606080695754399953560994389634889003541.1666666666666666666666666666666666666666666666707789998900021944366766,
    0,
    -366142336836811912436858082151197348755196068343029904344422889941174074568185882959826276647287333812450176725368256809219992770773823150701229725802154831738821802610112733870153866719571491588870558284840258.0728922340860026839372192076550557208705232275532993920531191020,
    0,
    361760902723728623488554609298914089477541475968819572031634249129851964628551371144863312914358761183479722875560266199064202767417431852451403213909430148601062959657738967139333352545438783530712395150222961683.90774918523012110935333043345697895684767003186385347224255,
    0
]

global bernoulli(x) = bernoulliArray[x]

//
// Trigonometric Functions
//

// create the sin function
global sin(z) = [math sin: (z % (2PI))]
sin([z class] == org.taffy.core.maths.ComplexNumber) = 0.5 * i * (e^(-i * z) - e^(i * z))
kernel constify: "sin"

// create the cos function
global cos(z) = sin(PI/2 - z)
cos([z class] == org.taffy.core.maths.ComplexNumber) = 0.5 * (e^(i * z) + e^(-i * z))
kernel constify: "cos"

// create the tan function
global tan(z) = (e^(2 * i * z) - 1) / (i * (e^(2 * i * z) + 1))
tan([z class] == Number) = sin(z) / cos(z)
kernel constify: "tan"

global const asin(z) = -i * ln(i * z + sqrt(1 - z^2))
global const acos(z) = 0.5 * PI + i * ln(i * z + sqrt(1 - z^2))
global const csc(z) = (2i) / (e^(i * z) - e^(-i * z))
global const acsc(z) = -i * ln(sqrt(1 - 1/(z^2)) + (i / z))
global const cot(z) = i * (e^(2 * i * z) + 1) / (e^(2 * i * z) - 1)
global const acot(z) = (i / 2) * (ln((z - i) / z) - ln((z + i) / z))
global const sec(z) = 2 / (e^(i * z) + e^(-1 * i * z))
global const asec(z) = 0.5 * PI + i * ln(sqrt(1 - (1 / z^2)) + (i / z))

// create the arc tangent function
global atan(z) = [math atan: z]
atan([z class] == org.taffy.core.maths.ComplexNumber) = 0.5 * i * (ln(1 - i * z) - ln(1 + i * z))
kernel constify: "atan"

//
// Hyperbolic Trigonometric Functions
//
global const sinh(z) = 0.5 * (e^z - e^(-z))
global const cosh(z) = 0.5 * (e^z + e^(-z))
global const tanh(z) = (e^(2z) - 1) / (e^(2z) + 1)
global const sech(z) = 2 / (e^z + e^(-z))
global const csch(z) = 2 / (e^z - e^(-z))
global const coth(z) = (e^(2z) + 1) / (e^(2z) - 1)
// inverses
global const asinh(z) = ln(z + sqrt(1 + z^2))
global const acosh(z) = ln(z + sqrt(z + 1) * sqrt(z - 1))
global const atanh(z) = 0.5 * (ln(1 + z) - ln(1 - z))
global const asech(z) = ln(sqrt(1/z - 1) * sqrt(1/z + 1) + 1/z)
global const acsch(z) = ln(sqrt(1 + 1/(z^2)) + 1/z)
global const acoth(z) = 0.5 * (ln(1 + 1/z) - ln(1 - 1/z))

//
// sign
//
global sgn(x) = 0
sgn(x >= 0) = 1
sgn(x < 0) = -1
kernel constify: "sgn"
